<!DOCTYPE html>
<html>
<head>
    <title>Flight Results</title>
    <style type="text/css">
        table, th, td {
            border: 0.5px solid black;
        }
    </style>
    <link rel="stylesheet" href="/static/style.css">
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('flight-selection-form').addEventListener('change', function() {
                var outboundSelection = document.querySelector('input[name="selected_outbound"]:checked');
                var inboundSelection = document.querySelector('input[name="selected_inbound"]:checked');
        
                var totalCost = 0;
                if (outboundSelection) totalCost += parseFloat(outboundSelection.getAttribute('data-price'));
                if (inboundSelection) totalCost += parseFloat(inboundSelection.getAttribute('data-price'));
        
                document.getElementById('total-cost').textContent = 'Total Cost: $' + totalCost.toFixed(2);
            });
        });
    </script>
</head>
<body>
    <a href="/">Back</a>
    <h1>Flight Results</h1>
    <!-- <br> -->

    <form id="flight-selection-form" action="/purchase" method="post">

        <h2>Outbound flights</h2>
        <table>
            <tr>
                <th>Airline</th>
                <th>Flight Number</th>
                <th>Origin</th>
                <th>Destination</th>
                <th>Departure Date</th>
                <th>Departure Time</th>
                <th>Price</th>
                <th>Select</th>

            </tr>
            {% for flight in outbound_flights %}
            <tr>
                <td>{{ flight['airline_name'] }}</td>
                <td>{{ flight['flight_num'] }}</td>
                <td>{{ flight['departure_airport'] }}</td>
                <td>{{ flight['arrival_airport'] }}</td>
                <td>{{ flight['departure_date'] }}</td>
                <td>{{ flight['departure_time'] }}</td>
                <td>{{ flight['base_price_ticket'] }}</td>
                <td><input type="radio" name="selected_outbound" value="{{ flight['flight_num'] }}_{{ flight['airline_name'] }}_{{ flight['departure_date'] }}_{{ flight['departure_time'] }}" data-price = "{{ flight['base_price_ticket'] }}"></td> <!-- Concatenation of strings since it's a weak entity and there are 4 primary keys -->
            </tr>
            {% endfor %}
        </table>

        <br>
        <!-- <hr> -->

        {% if inbound_flights %} <!-- Check if there are inbound flights to display -->
        <h2>Inbound flights</h2>
        <table>
            <tr>
                <th>Airline</th>
                <th>Flight Number</th>
                <th>Origin</th>
                <th>Destination</th>
                <th>Departure Date</th>
                <th>Departure Time</th>
                <th>Price</th>
                <th>Select</th>
            </tr>
            {% for flight in inbound_flights %}
            <tr>
                <td>{{ flight['airline_name'] }}</td>
                <td>{{ flight['flight_num'] }}</td>
                <td>{{ flight['departure_airport'] }}</td>
                <td>{{ flight['arrival_airport'] }}</td>
                <td>{{ flight['departure_date'] }}</td>
                <td>{{ flight['departure_time'] }}</td>
                <td>{{ flight['base_price_ticket'] }}</td>
                <td><input type="radio" name="selected_inbound" value="{{ flight['flight_num'] }}_{{ flight['airline_name'] }}_{{ flight['departure_date'] }}_{{ flight['departure_time'] }}" data-price = "{{ flight['base_price_ticket'] }}"></td> <!-- Concatenation of strings since it's a weak entity and there are 4 primary keys -->
            </tr>
            {% endfor %}
        </table>
        <br> 
        {% endif %}
        <br>
        <!-- A total view and submit button to submit the selected flights - next page -->
        <div>
            <span id="total-cost">Total Cost: $0</span>
            <input type="submit" value="Confim Selection">
        </div>
    </form>

    <!-- 
    Flask Code for using concatenated strings
    @app.route('/purchase', methods=['POST'])
    def purchase_flight():
    selected_outbound = request.form['selected_outbound']
    flight_num, airline_name, departure_date, departure_time = selected_outbound.split('_')
    
    # Now you can use flight_num, airline_name, departure_date, and departure_time
    # to identify the flight in the database and proceed with the purchase process
    
    # ... rest of your code to handle the purchase ...
    
    return redirect(url_for('confirmation_page'))  # Redirect to a confirmation page or another appropriate route

     -->
</body>
</html>